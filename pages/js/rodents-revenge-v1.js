(()=>{var t={101(t){function s(t){return Promise.resolve().then(()=>{var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s})}s.keys=()=>[],s.resolve=s,s.id=101,t.exports=s}},s={};function e(i){var h=s[i];if(void 0!==h)return h.exports;var r=s[i]={exports:{}};return t[i](r,r.exports,e),r.exports}e.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),(()=>{"use strict";let t={up:!1,down:!1,left:!1,right:!1,number:-1,p:!1},s={leftClick:!1,middleClick:!1,rightClick:!1,x:0,y:0,width:0,height:0};const i=document.getElementById("game");function h(t){a(t),s.leftClick=!0,t.preventDefault()}function r(t){s.leftClick=!1,t.preventDefault()}function a(t){let e=t.changedTouches[0];s.x=e.pageX-i.offsetLeft,s.y=e.pageY-i.offsetTop,t.preventDefault()}function o(t){let e=document.getScroll();s.x=t.clientX-i.offsetLeft+e[0],s.y=t.clientY-i.offsetTop+e[1]}function n(t){s.leftClick=!1}function l(t){0==t.button&&(s.leftClick=!0)}function d(s){39==s.keyCode?t.right=!0:37==s.keyCode?t.left=!0:38==s.keyCode?(t.up=!0,s.preventDefault()):40==s.keyCode?(t.down=!0,s.preventDefault()):80==s.keyCode?t.p=!0:s.keyCode>47&&s.keyCode<58&&(t.number=s.keyCode-48)}function c(s){39==s.keyCode?t.right=!1:37==s.keyCode?t.left=!1:38==s.keyCode?t.up=!1:40==s.keyCode?t.down=!1:80==s.keyCode?t.p=!1:s.keyCode>47&&s.keyCode<58&&(t.number=-1),s.preventDefault()}document.getScroll=function(){if(null!=window.scrollY)return[scrollX,scrollY];{let t,s,e=document,i=e.documentElement,h=e.body;return t=i.scrollLeft||h.scrollLeft||0,s=i.scrollTop||h.scrollTop||0,[t,s]}};class g{constructor(t,s,e,i,h=null){this._x=t,this._y=s,this.width=e,this.height=i,this.src=h}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}update(t,s,e){}draw(t,s){null!=this.src&&s[this.src](this.x,this.y)}collides(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&t.y+t.height>this.y&&t.y<this.y+this.height}}class u extends g{constructor(t,s,e,i,h,r,a){super(t,s,e,i,h),this.animFrames=r,this.animTiming=a,this.anim=0,this.loops=0}update(t,s,e){this.anim+=t,this.anim>this.animFrames*this.animTiming&&(this.anim=0,this.loops++)}draw(t,s){let e=Math.floor(this.anim/this.animTiming);s[this.src](e,this.x,this.y)}}class p extends g{constructor(t,s,e,i,h=null){super(t,s,e,i,h),this.cooldown=0,this.delay=30}update(t,s,e,i=this.leftClicked,h=this){e.leftClick&&0==this.cooldown&&this.collides(e)?(i(h),this.cooldown=this.delay):this.cooldown<0?this.cooldown=0:this.cooldown>0&&(this.cooldown-=t)}draw(t,s){null!=this.src&&s[this.src](this.x,this.y)}leftClicked(){console.log("clicked")}collides(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&t.y+t.height>this.y&&t.y<this.y+this.height}}class f{constructor(t,s,e,i,h,r=g){this.x=t,this.y=s,this.cols=e,this.rows=i,this.gridsize=h,this.width=e*h,this.height=i*h,this.clear(r)}draw(t,s){for(let e of this._grid)for(let i of e)i.draw(t,s)}update(t,s,e){for(let i of this._grid)for(let h of i)h.update(t,s,e)}clear(t=g){var s;this._grid=(s=this.rows,Array.apply(null,Array(s)));for(let s=0;s<this.rows;s++){this._grid[s]=[];for(let e=0;e<this.cols;e++)this._grid[s][e]=new t(this.gridsize*e,this.gridsize*s,this.gridsize,this.gridsize)}}}class w extends g{constructor(t,s,e){super(s,e,38,38),this.i=t,this.states={idle:new m(this),sitting:new v(this),sat:new x(this),walking:new _(this),cheese:new P(this)},this.state="idle",this.prevState="walking",this.cooldown=0,this.startingWalk=0,this.facing=1}get x(){return this._x}get y(){return this._y}set x(t){this._x=t;for(let s of Object.values(this.states))s.x=t}set y(t){this._y=t;for(let s of Object.values(this.states))s.y=t}update(t,s,e){"cheese"!=this.state&&("idle"==this.state&&"idle"!=this.prevState?(0==this.cooldown?this.cooldown=120:this.cooldown-=t,this.cooldown<=0&&(this.prevState="idle")):"idle"!=this.state&&(this.prevState=this.state),"sat"==this.state&&(this.cooldown>0?this.cooldown-=t:this.state="cheese"),this.states[this.state].update(t,s,e),"sitting"==this.state&&this.states.sitting.loops>0&&(this.state="sat",this.cooldown=90+t))}draw(t,s){s.planks(this.x,this.y),this.states[this.state].draw(t,s)}}class y extends u{constructor(t,s,e,i){super(t.x,t.y,38,38,s,e,i),this.cat=t}}class m extends y{constructor(t){super(t,"cat_idle_r",2,50)}update(t,s,e){1==this.cat.facing?this.src="cat_idle_r":this.src="cat_idle",super.update(t,s,e)}}class v extends y{constructor(t){super(t,"cat_sit",2,50)}}class _ extends y{constructor(t){super(t,"cat_walk_r",6,10)}update(t,s,e){1==this.cat.facing?this.src="cat_walk_r":this.src="cat_walk",super.update(t,s,e)}}class x extends g{constructor(t){super(t.x,t.y,38,38,"cat_sit")}draw(t,s){s.cat_sit(2,this.x,this.y)}}class P extends g{constructor(t){super(t.x,t.y,38,38,"cheese")}}class k extends f{constructor(t){super(0,38,24,22,38,C),this.game=t,this.cooldown=50,this.cheeselessTimer=50,this.resetWorld()}resetWorld(){for(let t=3;t<this.rows-3;t++)for(let s=3;s<this.cols-3;s++)t>6&&t<this.rows-7&&s>6&&s<this.cols-7||(this._grid[t][s]=new S(this.xAt(s),this.yAt(t)));let t=this.game.level-2;for(let s=0;s<=t;s++){let t=Math.floor(Math.random()*this.rows),s=Math.floor(Math.random()*this.cols);this._grid[t][s]=new M(this.xAt(s),this.yAt(t))}this.cheeseCollected=0,this.catPos=[];for(let t=0;t<this.game.level+1;t++){let s=Math.floor(6*Math.random()),e=Math.floor(6*Math.random());for(e>2&&(e+=18),s>2&&(s+=16);this._grid[s][e]instanceof w;)s=Math.floor(3*Math.random()),e=Math.floor(3*Math.random());this.catPos.push([e,s]),this._grid[s][e]=new w(t,this.xAt(e),this.yAt(s))}this.playerPos=[11,11],this._grid[11][11]=new T(this.xAt(11),this.yAt(11))}xAt(t){return this.x+this.gridsize*t}yAt(t){return this.y+this.gridsize*(t-1)}moveMouseLeft(){this.moveMouseHori(-1)}moveMouseRight(){this.moveMouseHori(1)}moveMouseUp(){this.moveMouseVert(-1)}moveMouseDown(){this.moveMouseVert(1)}moveMouseHori(t){if(this.playerPos[0]==(1==t?this.cols-1:0))return;let s=this._grid[this.playerPos[1]][this.playerPos[0]+t],e=this._grid[this.playerPos[1]][this.playerPos[0]];if(s instanceof C)this._grid[this.playerPos[1]][this.playerPos[0]]=s,this._grid[this.playerPos[1]][this.playerPos[0]+t]=e,this.playerPos[0]+=t,s.x-=t*this.gridsize,e.x+=t*this.gridsize;else if(s instanceof w){if("cheese"==s.state)return this.game.score+=100*this.game.level,this._grid[this.playerPos[1]][this.playerPos[0]+t]=new C(this.xAt(this.playerPos[0]+t),this.yAt(this.playerPos[1])),this.moveMouseHori(t),void this.cheeseCollected++;this.game.gameOver()}else if(s instanceof S){let i,h,r,a;function o(t,s){return i=t._grid[t.playerPos[1]][s],i instanceof S?(void 0!==r&&(r=-1),!0):i instanceof w&&(void 0===r&&(r=s),!0)}if(1==t)for(h=this.playerPos[0]+1;h<this.cols&&(a=o(this,h),a);h++);else for(h=this.playerPos[0]-1;h>-1&&(a=o(this,h),a);h--);if(!(i instanceof C))return;if(-1==r)if(1==t)for(let n=h;n>this.playerPos[0]+1;n--){let l=this._grid[this.playerPos[1]][n-1];l.x+=this.gridsize,this._grid[this.playerPos[1]][n]=l,l instanceof w&&(this.catPos[l.i]=[n,this.playerPos[1]])}else for(let d=h;d<this.playerPos[0]-1;d++){let c=this._grid[this.playerPos[1]][d+1];c.x-=this.gridsize,this._grid[this.playerPos[1]][d]=c,c instanceof w&&(this.catPos[c.i]=[d,this.playerPos[1]])}else if(void 0!==r){let g=this._grid[this.playerPos[1]][r];this._grid[this.playerPos[1]][r]=s,this._grid[this.playerPos[1]][h]=g,s.x=this.gridsize*r,g.x=this.gridsize*h,this.catPos[g.i]=[h,this.playerPos[1]]}else this._grid[this.playerPos[1]][h]=s,s.x=this.gridsize*h;this._grid[this.playerPos[1]][this.playerPos[0]+t]=e,this._grid[this.playerPos[1]][this.playerPos[0]]=i,this.playerPos[0]+=t,i.x=e.x,e.x+=t*this.gridsize}}moveMouseVert(t){if(this.playerPos[1]==(1==t?this.rows-1:0))return;let s=this._grid[this.playerPos[1]][this.playerPos[0]],e=this._grid[this.playerPos[1]+t][this.playerPos[0]];if(e instanceof C)this._grid[this.playerPos[1]][this.playerPos[0]]=e,this._grid[this.playerPos[1]+t][this.playerPos[0]]=s,this.playerPos[1]+=t,e.y-=t*this.gridsize,s.y+=t*this.gridsize;else if(e instanceof w){if("cheese"==e.state)return this.game.score+=100*this.game.level,this._grid[this.playerPos[1]+t][this.playerPos[0]]=new C(this.xAt(this.playerPos[0]),this.yAt(this.playerPos[1]+t)),this.moveMouseVert(t),void this.cheeseCollected++;this.game.gameOver()}else if(e instanceof S){let i,h,r,a;function o(t,s){return i=t._grid[s][t.playerPos[0]],i instanceof S?(void 0!==r&&(r=-1),!0):i instanceof w&&(void 0===r&&(r=s),!0)}if(1==t)for(h=this.playerPos[1]+1;h<this.rows&&(a=o(this,h),a);h++);else for(h=this.playerPos[1]-1;h>-1&&(a=o(this,h),a);h--);if(!(i instanceof C))return;if(-1==r)if(1==t)for(let n=h;n>this.playerPos[1]+1;n--){let l=this._grid[n-1][this.playerPos[0]];l.y+=this.gridsize,this._grid[n][this.playerPos[0]]=l,l instanceof w&&(this.catPos[l.i]=[this.playerPos[0],n])}else for(let d=h;d<this.playerPos[1]-1;d++){let c=this._grid[d+1][this.playerPos[0]];c.y-=this.gridsize,this._grid[d][this.playerPos[0]]=c,c instanceof w&&(this.catPos[c.i]=[this.playerPos[0],d])}else if(void 0!==r){let g=this._grid[r][this.playerPos[0]];this._grid[r][this.playerPos[0]]=e,this._grid[h][this.playerPos[0]]=g,e.y=this.gridsize*r,g.y=this.gridsize*h,this.catPos[g.i]=[this.playerPos[0],h]}else this._grid[h][this.playerPos[0]]=e,e.y=this.gridsize*h;this._grid[this.playerPos[1]+t][this.playerPos[0]]=s,this._grid[this.playerPos[1]][this.playerPos[0]]=i,this.playerPos[1]+=t,i.y=s.y,s.y+=t*this.gridsize}}moveCat(t,s){let e,i=this._grid[s][t];if("walking"!=i.state&&"idle"!=i.state||[t,s]==this.playerPos)return this.cheeselessTimer--,void(this.cheeselessTimer<1&&(this.cheeseCollected++,this.cheeselessTimer=50));this.cheeselessTimer=50,e=0==s?[this._grid[s+1][t],null,this._grid[s][t+1],this._grid[s][t-1],this._grid[s+1][t+1],this._grid[s+1][t-1],null,null]:s==this.rows-1?[null,this._grid[s-1][t],this._grid[s][t+1],this._grid[s][t-1],null,null,this._grid[s-1][t+1],this._grid[s-1][t-1]]:[this._grid[s+1][t],this._grid[s-1][t],this._grid[s][t+1],this._grid[s][t-1],this._grid[s+1][t+1],this._grid[s+1][t-1],this._grid[s-1][t+1],this._grid[s-1][t-1]];let h,r,a=e.map(t=>t instanceof C||t instanceof T),o=a[7],n=a[1],l=a[6],d=a[3],c=a[2],g=a[5],u=a[0],p=a[4],f=[];h=this.playerPos[0]>t?1:this.playerPos[0]<t?-1:0,r=this.playerPos[1]>s?1:this.playerPos[1]<s?-1:0,i.facing=h,-1==h?(1==r&&g&&f.push([s+1,t-1]),-1==r&&o&&f.push([s-1,t-1]),d&&0==f.length&&f.push([s,t-1])):1==h?(1==r&&p&&f.push([s+1,t+1]),-1==r&&l&&f.push([s-1,t+1]),c&&0==f.length&&f.push([s,t+1])):-1==r?n&&f.push([s-1,t]):1==r&&u&&f.push([s+1,t]);let w=f[0];if(0==f.length||i.idleCooldown>0?(i.state="idle",i.startingWalk=0,-1==h?d&&f.push([s,t-1]):1==h?c&&f.push([s,t+1]):-1==r?(o&&f.push([s-1,t-1]),l&&f.push([s-1,t+1])):1==r?(g&&f.push([s+1,t-1]),p&&f.push([s+1,t+1])):(n&&f.push([s-1,t]),u&&f.push([s+1,t])),-1==r?n&&f.push([s-1,t]):1==h?u&&f.push([s+1,t]):-1==h?(g&&f.push([s+1,t-1]),o&&f.push([s-1,t-1])):1==h?(l&&f.push([s-1,t+1]),p&&f.push([s+1,t+1])):(d&&f.push([s,t-1]),c&&f.push([s,t+1])),w=f[Math.floor(Math.random()*f.length)]):2==i.startingWalk?i.state="walking":i.startingWalk++,0==f.length){if(n&&f.push([s-1,t]),u&&f.push([s+1,t]),d&&f.push([s,t-1]),c&&f.push([s,t+1]),g&&f.push([s+1,t-1]),p&&f.push([s+1,t+1]),o&&f.push([s-1,t-1]),l&&f.push([s-1,t+1]),0==f.length)return void(i.state="sitting");w=f[Math.floor(Math.random()*f.length)]}let y=this._grid[w[0]][w[1]];this._grid[w[0]][w[1]]=i,y instanceof T?(this._grid[s][t]=new C(this.xAt(t),this.yAt(s)),this.game.gameOver()):(this._grid[s][t]=y,y.x=this.xAt(t),y.y=this.yAt(s)),i.x=this.xAt(w[1]),i.y=this.yAt(w[0]),this.catPos[i.i]=[w[1],w[0]]}update(t,s,e){if(!this.game.game_over&&(this.cooldown-=t,this.cooldown<0)){for(let t=0;t<this.catPos.length;t++)this.moveCat(...this.catPos[t]);this.cooldown=50}super.update(t,s,e)}}class C extends g{constructor(t,s){super(t,s,38,38,"planks")}}class S extends g{constructor(t,s){super(t,s,38,38,"crate")}}class M extends g{constructor(t,s){super(t,s,38,38)}draw(t,s){t.fillStyle="rgba(217, 160, 102, 0.5)",t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="#7d4f35",t.fillRect(this.x,this.y,this.width,4),t.fillRect(this.x,this.y+this.height-4,this.width,4),t.fillRect(this.x,this.y,4,this.height),t.fillRect(this.x+this.width-4,this.y,4,this.height)}}class T extends g{constructor(t,s){super(t,s,38,38,"mouse")}draw(t,s){s.planks(this.x,this.y),super.draw(t,s)}}class b extends g{constructor(t,s,e){super(s,e,277,186),this.grid=t,this.left=new p(this.x-this.width/2,this.y+90,90,100,"dpad_left"),this.down=new p(this.x-this.width/2+90,this.y+90,90,100,"dpad_down"),this.right=new p(this.x-this.width/2+180,this.y+90,97,100,"dpad_right"),this.up=new p(this.x-this.width/2+90,this.y,100,100,"dpad_up"),this.left.delay=10,this.down.delay=10,this.right.delay=10,this.up.delay=10}update(t,s,e){this.grid.game.game_over||(s.left&&0==this.left.cooldown?(this.leftPressed(this),this.left.cooldown=10):s.down&&0==this.down.cooldown?(this.downPressed(this),this.down.cooldown=10):s.right&&0==this.right.cooldown?(this.rightPressed(this),this.right.cooldown=10):s.up&&0==this.up.cooldown&&(this.upPressed(this),this.up.cooldown=10),this.left.update(t,s,e,this.leftPressed,this),this.down.update(t,s,e,this.downPressed,this),this.right.update(t,s,e,this.rightPressed,this),this.up.update(t,s,e,this.upPressed,this))}draw(t,s){this.left.draw(t,s),this.down.draw(t,s),this.right.draw(t,s),this.up.draw(t,s)}leftPressed(t){t.grid.moveMouseLeft()}downPressed(t){t.grid.moveMouseDown()}rightPressed(t){t.grid.moveMouseRight()}upPressed(t){t.grid.moveMouseUp()}}class I{constructor(t){this.game=t,this.grid=new k(t),this.dpad=new b(this.grid,t.ctx.canvas.width/2,this.grid.height),this.scoreDisplay=new E(t,t.ctx.canvas.width/2-this.dpad.width,this.grid.height+48,"score"),this.hiscoreDisplay=new E(t,t.ctx.canvas.width/2-this.dpad.width,this.grid.height+104,"high_score","Best: ","1.75rem var(--arcade-font)"),this.levelDisplay=new E(t,t.ctx.canvas.width/2+this.dpad.width,this.grid.height+48,"level","Level: ")}update(t,s,e){this.grid.cheeseCollected==this.game.level+1&&(this.game.level++,this.grid=new k(this.game),this.dpad.grid=this.grid),this.grid.update(t,s,e),this.dpad.update(t,s,e)}draw(t,s){t.clearRect(0,0,t.canvas.width,t.canvas.height),this.grid.draw(t,s),this.dpad.draw(t,s),this.scoreDisplay.draw(t),this.hiscoreDisplay.draw(t),this.levelDisplay.draw(t)}}class E{constructor(t,s,e,i,h="Score: ",r="2.25rem var(--arcade-font)",a="#fff"){this.game=t,this.variable=i,this.x=s,this.y=e,this.font=r,this.label=h,this.colour=a}draw(t){t.font=this.font,t.fillStyle=this.colour;let s=`${this.label}${this.game[this.variable]}`;t.fillText(s,this.x-t.measureText(s).width/2,this.y)}}class L extends p{constructor(t,s,e,i,h,r="#000",a="#fff"){super(t,s,e,i),this.text=h,this.outline=r,this.colour=a}draw(t,s){t.fillStyle=this.outline,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle=this.colour,t.fillRect(this.x+2,this.y+2,this.width-4,this.height-4),t.fillStyle=this.outline,t.font="1rem var(--arcade-font)",t.fillText(this.text,this.x+(this.width/2-t.measureText(this.text).width/2),this.y+this.height/2+8)}}class A{constructor(t){this.button=new z(t,t.ctx.canvas.width/2-288,t.ctx.canvas.height/2-32),this.world=new I(t),this.game=t}update(t,s,e){this.button.update(t,s,e,function(t){t.game.changeScene(t.world)},this)}draw(t,s){t.clearRect(0,0,t.canvas.width,t.canvas.height),this.world.draw(t,s),this.game.darkenCanvas(t),t.fillStyle="#fff";let e="Rodent's Revenge";t.fillText(e,this.button.x+this.button.width/2-t.measureText(e).width/2,this.button.y-28),this.button.draw(t,s)}}class z extends L{constructor(t,s,e){super(s,e,576,96,"PLAY","rgba(255, 255, 255, 1.0)","rgba(55, 95, 145, 1.0)"),this.game=t}}class D{constructor(t){this.game=t,this.drawn=!1,t.darkenCanvas(t.ctx)}update(t,s,e){}draw(t,s){this.drawn||(t.fillStyle="#000",t.fillRect(t.canvas.width/4,t.canvas.height/2-t.canvas.height/6,t.canvas.width/2,t.canvas.height/4),t.fillStyle="#fff",t.fillRect(t.canvas.width/4+2,t.canvas.height/2-t.canvas.height/6+2,t.canvas.width/2-4,t.canvas.height/4-4),t.font="2.25rem var(--arcade-font)",t.fillStyle="#000",t.fillText("Paused",t.canvas.width/2-86,t.canvas.height/2-6),this.drawn=!0)}}let R,O,U;class W extends Error{}(async t=>{try{return await e(101)(t)}catch(s){throw new W(t)}})("../send_score.js").then(t=>{R=t.send_score,O=t.hide_send_score_button}).catch(t=>{console.log("Failed to import score button functionality"),R=()=>null,O=()=>null});class B{constructor(t){this.game=t,t.game_over=!0,function(t){const s=document.getElementById("send_score_button");if(s){function e(i){R(document.getElementById("game_title").dataset.filename,t.score,s.dataset.csrfToken),i.currentTarget.setAttribute("style","display: none;"),i.currentTarget.removeEventListener("click",e),i.stopPropagation()}s.setAttribute("style","z-index: 100; display: block; left: 50%; top: 50%; transform: translate(-50%);"),s.addEventListener("click",e)}}(t)}update(t,s,e){this.game.allowUserInput=!1,this.game.prevScene.update(t,s,e),this.game.allowUserInput=!0,e.leftClick&&(O(),this.game.game_over=!1,this.game.level=1,this.game.score=0,this.game.changeScene(new A(this.game)))}draw(t,s){this.game.prevScene.draw(t,s),this.game.darkenCanvas(t);const e="tap or click to restart";t.fillStyle="#000",t.fillRect(t.canvas.width/4,t.canvas.height/3-t.canvas.height/6,t.canvas.width/2,t.canvas.height/4),t.fillStyle="#800000",t.fillRect(t.canvas.width/4+2,t.canvas.height/3-t.canvas.height/6+2,t.canvas.width/2-4,t.canvas.height/4-4),t.font="3.25rem var(--arcade-font)",t.fillStyle="#fff",t.fillText("Game Over",t.canvas.width/2-t.measureText("Game Over").width/2,t.canvas.height/3-32),t.font="1.25rem var(--arcade-font)",t.fillText(e,t.canvas.width/2-t.measureText(e).width/2,t.canvas.height/3+22)}}class j{constructor(t){this.paused=!1,this.game_over=!1,this.level=1,this.score=0,U=Date.now(),this.ctx=t,this.allowUserInput=!0,this.timer=[0,function(){},this],this.scene=new A(this),this.prevScene=this.scene,this.high_score=null,void 0!==typeof Storage&&(this.high_score=localStorage.getItem("high_score")),null==this.high_score&&(this.high_score=0)}update(t,s){let e=(i=Date.now()-U,Math.min(i/(1e3/60),2));var i;if(this.timer[0]>0?this.timer[0]-=e:this.timer[0]<0&&(this.timer[0]=0,this.timer[1](this.timer[2])),this.allowUserInput||(s.leftClick=!1,t.p=!1),this.scene.update(e,t,s),U=Date.now(),!this.game_over&&t.p&&(this.paused=!this.paused),this.paused&&!0!==this.scene.isPausedScene)this.changeScene(new D(this,this.ctx));else if(!this.paused&&this.scene.isPausedScene){let t=this.prevScene;this.changeScene(t)}}draw(t,s){this.scene.draw(t,s)}setTimer(t,s,e){this.timer=[t,s,e]}changeScene(t){let s=this.scene;this.prevScene=s,this.allowUserInput=!1,this.timer=[10,function(t){t.allowUserInput=!0},this],t.isPausedScene=this.paused,this.scene=t}darkenCanvas(t){t.fillStyle="rgba(0, 0, 0, 0.5)",t.fillRect(0,0,t.canvas.width,t.canvas.height)}gameOver(){this.game_over||(this.score>this.high_score&&(this.high_score=this.score,void 0!==typeof Storage&&localStorage.setItem("high_score",this.high_score)),this.changeScene(new B(this)))}}const F=document.getElementById("game"),H=document.createElement("canvas");F.appendChild(H),H.width=F.offsetWidth,H.height=F.offsetHeight;const Y=H.getContext("2d");let V;Y.fillStyle="#000",Y.fillRect(0,0,H.width,H.height),Y.font="3rem var(--arcade-font)",Y.fillStyle="#fff",Y.fillText("loading",H.width/2-Y.measureText("loading").width/2,H.height/2-H.height/6);let X=0,G={cat:new Image,mouse:new Image,cheese:new Image,planks:new Image,crate:new Image,input:new Image};const N={cat_idle:function(t,s,e){Y.drawImage(G.cat,42+42*t,0,38,30,s,e+4,38,30)},cat_idle_r:function(t,s,e){Y.save(),Y.translate(s+38,e),Y.scale(-1,1),this.cat_idle(t,0,0),Y.restore()},cat_sit:function(t,s,e){Y.drawImage(G.cat,0==t?0:126,0,38,30,s,e+4,38,30)},cat_walk:function(t,s,e,i=4){Y.drawImage(G.cat,i+44*t,35,44,30,s,e+4,42,30)},cat_walk_r:function(t,s,e){Y.save(),Y.translate(s+42,e),Y.scale(-1,1),this.cat_walk(t,0,0,0),Y.restore()},mouse:function(t,s){Y.drawImage(G.mouse,t,s)},cheese:function(t,s){Y.drawImage(G.cheese,t,s)},planks:function(t,s){Y.drawImage(G.planks,t,s)},crate:function(t,s){Y.drawImage(G.crate,t,s)},dpad_left:function(t,s){Y.drawImage(G.input,0,90,90,100,t,s,90,100)},dpad_down:function(t,s){Y.drawImage(G.input,90,90,90,100,t,s,90,100)},dpad_right:function(t,s){Y.drawImage(G.input,180,90,97,100,t,s,97,100)},dpad_up:function(t,s){Y.drawImage(G.input,90,0,100,100,t,s,100,100)}};function $(){X+=1,X==Object.keys(G).length&&(function(t){t.addEventListener("touchstart",h,!1),t.addEventListener("touchend",r,!1),t.addEventListener("touchmove",a,!1),t.addEventListener("mouseup",n,!1),t.addEventListener("mousedown",l,!1),t.addEventListener("mousemove",o,!1),document.addEventListener("contextmenu",function(t){i.contains(t.target)&&t.preventDefault()},!1),document.addEventListener("keydown",d,!1),document.addEventListener("keyup",c,!1)}(H),V=new j(Y),J())}const q="/img/rodents-revenge/";function J(){V.update(t,s),V.draw(Y,N),requestAnimationFrame(J)}G.cat.addEventListener("load",$),G.cat.src=q+"cat.png",G.mouse.addEventListener("load",$),G.mouse.src=q+"mouse.png",G.cheese.addEventListener("load",$),G.cheese.src=q+"cheese.png",G.planks.addEventListener("load",$),G.planks.src=q+"planks.png",G.crate.addEventListener("load",$),G.crate.src=q+"crate.png",G.input.addEventListener("load",$),G.input.src=q+"input.png",document.getElementById("pause_button").addEventListener("click",function(){V.game_over||(V.paused=!V.paused)},!1)})()})();